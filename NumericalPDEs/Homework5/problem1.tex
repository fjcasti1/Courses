\begin{questions}

\question{
Derive the modified PDE for the Lax-Friedrichs method for $u_t + c
u_x = 0$.  Find the coefficient $D_n \sim \{\Delta t, \Delta x\}$ of
numerical diffusion in $u_t + c u_x = D_n u_{xx}$.  Note that $D_n \ge
0$ iff the Courant number $r = c \Delta t/\Delta x \le 1$.
}
\begin{solution}
We start Taylor expanding the following terms
\begin{align*}
u_i^{n+1}&=u_i^n+\Delta tu_t+\frac{\Delta t^2}{2}u_{tt}+\dots\\
u_{i\pm 1}^n&=u_i^n\pm\Delta xu_x+\frac{\Delta x^2}{2}u_{xx}+\dots
\end{align*}
and substituting them into the Lax-Friedrichs method,
\begin{align*}
u^{n+1}_i&=\frac{1}{2}\left(u^n_{i+1}+u^n_{i-1}\right)-\frac{c\Delta t}{2\Delta x}\left(u^n_{i+1}-u^n_{i-1}\right),\\
u_i^n+\Delta tu_t+\frac{\Delta t^2}{2}u_{tt}&=\frac{1}{2}\left(2u_i^n+\Delta x^2u_{xx}\right)-\frac{c\Delta t}{2\Delta x}2\Delta x u_x+\dots,\\
u_t+\frac{\Delta t}{2}u_{tt}&\approx\frac{\Delta x^2}{2\Delta t}u_{xx}-cu_x,\\
u_t+cu_x&\approx\frac{\Delta x^2}{2\Delta t}u_{xx}-\frac{\Delta t}{2}u_{tt}.
\end{align*}
Using the PDE, we obtain that $u_{tt}=c^2u_{xx}$. Thus,
\begin{align*}
u_t+cu_x&\approx\frac{\Delta x^2}{2\Delta t}u_{xx}-c^2\frac{\Delta t}{2}u_{xx}\\
u_t+cu_x&\approx\frac{\Delta x^2}{2\Delta t}\left[1-r^2\right]u_{xx},
\end{align*}
where $r=c\Delta t/\Delta x$. Hence, we have obtained that the modified PDE is
\begin{align*}
u_t+cu_x=D_nu_{xx},
\end{align*}
with
\begin{align*}
D_n=\frac{\Delta x^2}{2\Delta t}\left[1-r^2\right].
\end{align*}
Note that
\begin{align*}
D_n\geq 0&\iff \left[1-r^2\right]\geq 0\\
&\iff r^2\leq 1\\
&\iff r\leq 1\\
\end{align*}
\end{solution}
\end{questions}
